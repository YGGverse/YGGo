source common
{
  type        = mysql

  sql_host    = localhost
  sql_user    =
  sql_pass    =
  sql_db      =
  sql_port    = 3306 # optional, default is 3306
}

source hostPage : common
{
  sql_query   = \
    SELECT hostPage.hostPageId, \
           hostPage.rank, \
           hostPage.uri, \
           host.name, \
          (SELECT CONCAT_WS(' ', hostPageDescription.metaTitle, \
                                 hostPageDescription.metaDescription, \
                                 hostPageDescription.metaKeywords) \
           FROM hostPageDescription \
           WHERE hostPageDescription.hostPageId = hostPage.hostPageId \
           ORDER BY hostPageDescription.timeUpdated DESC, hostPageDescription.timeAdded DESC \
           LIMIT 1) AS pageDescription \
    FROM hostPage \
    JOIN host ON (host.hostId = hostPage.hostId) \
    WHERE host.status = '1' AND hostPage.httpCode = 200 AND hostPage.timeBanned IS NULL

  sql_attr_uint = rank
}

source hostImage : common
{
  sql_query   = \
    SELECT hostImage.hostImageId, hostImage.rank, hostImage.uri, host.name, \
           (SELECT CONCAT_WS(' ', hostImageDescription.alt, hostImageDescription.title) \
              FROM hostImageDescription \
              WHERE hostImageDescription.hostImageId = hostImage.hostImageId \
              ORDER BY hostImageDescription.timeUpdated DESC, hostImageDescription.timeAdded DESC \
              LIMIT 1) AS imageDescription \
    FROM hostImage \
    JOIN host ON (host.hostId = hostImage.hostId) \
    WHERE host.status = '1' AND hostImage.httpCode = 200 AND hostImage.timeBanned IS NULL \

  sql_attr_uint = rank
}

index hostPage
{
  source     = hostPage
  morphology = stem_enru, stem_cz, stem_ar
  path       = /var/lib/sphinxsearch/data/hostPage
}

index hostImage
{
  source     = hostImage
  morphology = stem_enru, stem_cz, stem_ar
  path       = /var/lib/sphinxsearch/data/hostImage
}